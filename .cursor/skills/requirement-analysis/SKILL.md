---
name: requirement-analysis
description: 从 PRD 文档或需求描述中提取和分析需求，输出结构化的需求分析文档，包含功能需求、非功能需求和 PRD 问题清单。当用户提供 PRD 链接、需求描述，或要求分析需求、梳理功能点时使用。
---

# 需求分析

从 PRD 文档或需求描述中系统性地提取和分析需求，生成结构化的需求分析文档。适用于中小型需求的快速分析。

## 输入形式

支持以下任一输入：
- PRD 文档链接（如 Confluence、Notion、飞书文档）
- 需求描述文本
- 产品经理口述整理

## 分析流程

### 步骤 1：信息收集

**如果是文档链接**：
- 使用 WebFetch 获取文档内容
- 如无法访问，请用户提供文档文本

**如果是文本描述**：
- 直接解析需求内容
- 如描述不完整，询问关键缺失信息

**关键信息清单**：
- [ ] 功能背景与目标
- [ ] 目标用户群体
- [ ] 核心功能点列表
- [ ] 交互流程描述
- [ ] 验收标准

### 步骤 2：需求提取与分类

#### 2.1 功能需求提取

将需求描述拆解为具体功能点：

1. **核心功能**：必须实现的主要功能
2. **支撑功能**：保证核心功能运作的辅助功能
3. **增强功能**：提升体验但非必须的功能

**提取原则**：
- 每个功能点应可独立验收
- 使用「主语 + 动词 + 宾语」格式描述
- 区分 Must Have / Should Have / Nice to Have

#### 2.2 非功能需求识别

从以下维度检查是否有隐含的非功能需求：

| 维度 | 检查点 | 常见需求 |
|------|--------|----------|
| 性能 | 响应时间、并发量、数据量 | "XX 操作需在 X 秒内完成" |
| 可靠性 | 故障恢复、数据一致性 | "断网重连后数据不丢失" |
| 安全性 | 权限、隐私、数据保护 | "敏感信息需脱敏展示" |
| 兼容性 | 系统版本、设备适配 | "支持 Android 8.0+" |
| 可用性 | 无障碍、国际化 | "支持屏幕阅读器" |
| 可维护性 | 日志、监控、可配置 | "关键操作需要埋点" |

### 步骤 3：PRD 质量审查

检查 PRD 中的问题和遗漏：

#### 3.1 完整性检查

- [ ] 是否覆盖所有用户场景
- [ ] 是否有边界条件说明
- [ ] 是否有异常流程处理
- [ ] 是否有数据来源说明
- [ ] 是否有交互细节（空状态、加载态、错误态）

#### 3.2 清晰度检查

- [ ] 是否有歧义描述
- [ ] 是否有模糊用词（如"等"、"相关"、"类似"）
- [ ] 验收标准是否可量化

#### 3.3 一致性检查

- [ ] 前后描述是否矛盾
- [ ] 与现有功能是否冲突
- [ ] 术语使用是否统一

#### 3.4 可行性检查

- [ ] 技术上是否可实现
- [ ] 是否有强依赖外部系统
- [ ] 时间是否合理

### 步骤 4：生成分析文档

使用以下模板输出：

```markdown
# [功能名称] 需求分析

> 分析时间：YYYY-MM-DD
> 需求来源：[PRD 链接/口述整理]

## 1. 需求概述

### 1.1 背景与目标

[1-2 段描述业务背景和要解决的问题]

### 1.2 目标用户

- **主要用户**：[用户群体描述]
- **使用场景**：[典型使用场景]

---

## 2. 功能需求

### 2.1 核心功能（Must Have）

| 编号 | 功能点 | 描述 | 验收标准 |
|------|--------|------|----------|
| F-001 | [功能名] | [功能描述] | [可验证的标准] |
| F-002 | [功能名] | [功能描述] | [可验证的标准] |

### 2.2 支撑功能（Should Have）

| 编号 | 功能点 | 描述 | 验收标准 |
|------|--------|------|----------|
| F-101 | [功能名] | [功能描述] | [可验证的标准] |

### 2.3 增强功能（Nice to Have）

| 编号 | 功能点 | 描述 | 验收标准 |
|------|--------|------|----------|
| F-201 | [功能名] | [功能描述] | [可验证的标准] |

---

## 3. 非功能需求

| 编号 | 类型 | 需求描述 | 验收标准 | 来源 |
|------|------|----------|----------|------|
| NF-001 | 性能 | [描述] | [量化标准] | [显式/推断] |
| NF-002 | 安全 | [描述] | [量化标准] | [显式/推断] |
| NF-003 | 兼容性 | [描述] | [量化标准] | [显式/推断] |

---

## 4. PRD 问题清单

### 4.1 缺失信息（需补充）

| 编号 | 问题类型 | 问题描述 | 影响范围 | 建议 |
|------|----------|----------|----------|------|
| Q-001 | 信息缺失 | [具体缺失什么] | [影响哪些功能] | [建议补充内容] |
| Q-002 | 边界不清 | [什么边界不清楚] | [可能的歧义] | [建议明确内容] |

### 4.2 歧义描述（需澄清）

| 编号 | 原文 | 问题 | 可能的理解 | 建议 |
|------|------|------|-----------|------|
| A-001 | "[原文引用]" | [问题说明] | [理解1/理解2] | [建议明确方式] |

### 4.3 潜在风险（需关注）

| 编号 | 风险描述 | 风险等级 | 影响 | 建议 |
|------|----------|----------|------|------|
| R-001 | [风险描述] | 高/中/低 | [可能的影响] | [规避建议] |

---

## 5. 待确认事项

按优先级排序，需与产品/业务确认：

1. **【高】** [最需要确认的问题]
2. **【高】** [第二重要的问题]
3. **【中】** [其他需确认问题]
4. **【低】** [可后续确认问题]

---

## 6. 补充说明

### 6.1 假设条件

- [基于什么假设进行的分析]
- [如果假设不成立，哪些结论需要调整]

### 6.2 分析依据

- ✅ 显式需求：[来自 PRD 明确描述的内容]
- ⚠️ 推断需求：[基于行业惯例或上下文推断]
```

## 输出位置

将生成的文档保存至：
- 如有明确需求名：`docs/requirements/[feature-name]-analysis.md`
- 如无明确名称：询问用户命名偏好

## 快速分析模式

对于简单需求，可使用精简版输出：

```markdown
# [功能名称] 需求分析（精简版）

## 功能需求
1. [核心功能 1]
2. [核心功能 2]
3. [核心功能 3]

## 非功能需求
- 性能：[如有]
- 安全：[如有]
- 兼容：[如有]

## PRD 待确认问题
1. [问题 1]
2. [问题 2]
```

## 使用提示

### 何时使用详细模式
- 中大型功能需求
- 跨模块影响的需求
- 需要多方对齐的需求

### 何时使用快速模式
- 小功能优化
- 已经讨论清晰的需求
- 时间紧迫的初步评估

## 输出质量检查

- [ ] 功能需求可独立验收
- [ ] 非功能需求有量化标准
- [ ] 问题清单有具体建议
- [ ] 待确认事项按优先级排序
- [ ] 无遗漏关键场景
