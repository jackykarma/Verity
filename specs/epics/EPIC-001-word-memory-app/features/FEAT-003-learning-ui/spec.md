# Feature 规格说明：学习界面与交互

**Epic**：EPIC-001 - 无痛记忆单词神器APP  
**Feature 类型**：Product Feature  
**Feature ID**：FEAT-003  
**Feature Version**：v0.1.0  
**EPIC 分支**：`epic/EPIC-001-word-memory-app`  
**Feature 目录**：`specs/epics/EPIC-001-word-memory-app/features/FEAT-003-learning-ui/`  
**创建时间**：2026-01-19  
**状态**：草稿  
**输入**：用户描述：`"Feature 3 - 学习界面与交互"`

## 背景与价值 *（必填）*

- **背景**：
  - 学习界面是用户高频使用的核心路径，直接决定学习是否“顺畅、无痛、可持续”
  - 若交互流程不清晰/反馈不及时，用户会频繁中断，影响学习效率与留存
  - 需要将算法给出的学习任务（新学/复习）转化为直观的“卡片式学习体验”

- **目标**：
  - **用户目标**：用户能以最少步骤完成“看词 → 看答案 → 标记认识/不认识 → 下一题”的循环，并能随时看进度与退出/继续
  - **业务目标**：提升核心学习流程的完成率、连续学习体验，降低流失
  - **平台目标**：沉淀可复用的学习 UI 组件与交互规范，为后续游戏化/统计等功能提供统一入口与事件

- **价值**：
  - **用户价值**：学习流程清晰、操作顺手、反馈及时；在碎片时间也能稳定完成学习
  - **业务价值**：更高的日活与学习时长、更好的留存
  - **技术价值**：形成标准化的学习会话（session）与 UI 状态管理方式，降低后续扩展成本

- **范围（In Scope）**：
  - 单词卡片展示：单词/音标/释义（答案默认隐藏）、可选多媒体区域（图片/例句/发音入口）
  - 学习操作：显示答案/翻转；认识/不认识/跳过（或稍后）三类反馈；按钮与手势交互并存
  - 学习流程导航：开始学习/复习入口；题目切换；完成页
  - 学习进度提示：本轮已完成/总数、剩余数量；“今天还需复习/学习”的空状态
  - 基础可访问性：TalkBack 可聚焦与可读的关键控件（按钮、进度、答案显示）

- **范围外（Out of Scope）**：
  - 复杂的学习游戏/关卡/多人对战（由游戏化 Feature 承担）
  - 词库导入与管理（由单词库管理 Feature 承担）
  - 间隔重复算法细节与参数调优（由算法引擎 Feature 承担）
  - 多媒体资源的下载/缓存/版本管理细节（由多媒体支持 Capability 承担）

## 依赖关系 *（必填）*

- **上游依赖**：
  - **单词库管理（FEAT-001）**：当前选择词库、单词基础信息
  - **间隔重复学习算法引擎（FEAT-002）**：学习任务列表、提交学习反馈后返回下一任务/更新状态
  - **多媒体支持（FEAT-006）**：发音/图片/例句等资源的获取与播放/展示（本 Feature 只负责 UI 接入与降级）
  - **用户账户与数据管理（FEAT-007）**：学习会话与学习记录的本地持久化（若方案中需要）

- **下游影响**：
  - **学习进度与统计（FEAT-005）**：依赖学习事件与会话数据做统计展示
  - **游戏化与激励机制（FEAT-004）**：依赖学习完成/连续学习等事件触发奖励

- **外部依赖故障模式**：
  - **算法引擎返回空任务**：显示空状态（今日已完成/暂无可学），提供返回与刷新入口
  - **算法引擎提交反馈失败/超时**：提示“提交失败，可重试”，不丢失当前题目答案状态；重试成功后再进入下一题
  - **多媒体资源缺失/播放失败**：不阻断学习主流程；按钮置灰并提示原因（如“无发音资源/播放失败”）

> 说明（重要）：本 Feature 依赖横切能力（算法/多媒体/埋点）。这些能力的“契约/字段/错误语义/版本”应在对应 Capability Feature 中定义；本 Feature 只写清楚“需要什么能力 + 验收口径 + 降级行为”。

## 验收与场景 *（必填）*

> 说明：本节用于“可测试”的需求验收；**不等同于技术 Story**（技术 Story 在 Plan 阶段拆分）。

### 核心用户旅程（可选但强烈建议）

#### 旅程 1 - 进行一次学习会话（新学/复习通用）

- **描述**：用户进入学习界面，按“看题 → 显示答案 → 反馈 → 下一题”循环完成若干题目，直至完成
- **成功信号**：用户能顺畅完成 ≥ 20 题且无卡死/无丢进度；结束时出现完成页并可返回
- **验收场景**：
  1. **前提** 已选择词库且算法引擎返回待学习任务，**当** 用户进入学习界面，**则** 系统展示第 1 张单词卡片，答案默认隐藏，并显示“已完成/总数”
  2. **前提** 当前卡片答案隐藏，**当** 用户点击“显示答案/翻转”，**则** 系统展示释义（及可用的多媒体入口），并允许用户选择“认识/不认识/跳过”
  3. **前提** 当前卡片已显示答案，**当** 用户点击“认识/不认识/跳过”之一，**则** 系统提交反馈并进入下一张卡片，同时已完成数量 +1
  4. **前提** 本轮最后一张卡片已提交反馈，**当** 系统进入完成状态，**则** 展示完成页（本轮完成数、用时可选）并提供“返回/再学一组（可选）”

#### 旅程 2 - 中断与继续

- **描述**：用户学习过程中被打断（返回/切后台/横竖屏切换），稍后继续学习
- **成功信号**：用户回到学习界面后能够继续当前会话，不重复计算/不丢失当前题目与进度
- **验收场景**：
  1. **前提** 用户已完成 10/30 题且停留在第 11 题，**当** 用户切到后台再回到前台，**则** 仍显示第 11 题，并保持“答案是否已显示”的状态
  2. **前提** 用户在学习过程中点击返回，**当** 系统弹出退出确认，**则** 用户选择“继续学习”返回学习界面；选择“退出”则保存进度并返回上一层入口

### 边界与异常场景（必填）

- **未选择词库** → 引导用户先去选择/导入词库（跳转到 FEAT-001 相关入口），学习按钮不可用
- **无可学习/复习任务** → 显示空状态（例如“今天已完成”），提供返回与刷新
- **提交反馈失败/超时** → Toast/对话框提示 + 提供重试；不自动跳题；记录错误日志/事件
- **多媒体不可用（无音频/图片/例句）** → 对应入口隐藏或置灰，并有明确文案说明
- **快速连点/重复提交** → 同一题目在一次提交完成前必须防重复提交（UI 禁用/加载态）
- **横竖屏切换/进程被系统回收** → 通过状态保存恢复到“同一题目/同一进度”（至少恢复到同一题目）
- **无障碍** → 关键操作必须可被 TalkBack 聚焦并朗读；重要状态变化（显示答案/切题）应可感知

## FR / NFR *（必填）*

### FR（Functional Requirements）

> 规则：每条 FR 必须**可测试**，避免“提升体验/更快/更稳定”这类不可验证表述。

- **FR-001**：系统必须提供“开始学习/开始复习”入口，进入后展示由算法引擎返回的第 1 个学习任务对应的单词卡片
- **FR-002**：单词卡片必须默认隐藏答案（释义），用户必须能够通过“显示答案/翻转”操作显示答案
- **FR-003**：当答案已显示时，用户必须能够对当前单词提交至少三类反馈：认识 / 不认识 / 跳过（或稍后）
- **FR-004**：系统必须在提交反馈成功后进入下一题，并更新进度显示（已完成数、剩余/总数）
- **FR-005**：系统必须支持按钮交互；并至少支持一种高频手势交互（例如：左右滑动触发认识/不认识，或滑动切题），且手势与按钮结果一致
- **FR-006**：系统必须在“提交反馈中”显示加载态并禁用重复提交；若提交失败，必须停留在当前题并提供重试
- **FR-007**：系统必须在本轮题目完成后展示完成页，并提供返回入口（可选：再学一组）
- **FR-008**：系统必须在学习过程中支持中断与继续：返回时弹出确认；切后台/旋转屏幕后能恢复到当前题目及答案显示状态
- **FR-009**：若单词存在发音资源，用户必须能够点击“播放发音”；若不存在，入口必须置灰或隐藏并给出解释
- **FR-010**：若单词存在图片/例句等扩展信息，系统必须在答案显示后展示对应区域；若缺失，则不显示占位内容

### NFR（Non-Functional Requirements）

> 规则：每条 NFR 必须**量化**并附带验收方式；细化评估在 Plan 阶段完成。

#### 性能（Performance）

- **NFR-PERF-001**：进入学习界面首帧时间 p95 ≤ 500ms（在已获得学习任务数据的前提下）；切换到下一题的 UI 更新时间 p95 ≤ 100ms
- **NFR-PERF-002**：在连续学习 30 题的过程中，明显卡顿（>100ms 的长帧）占比 ≤ 1%（通过 Android 性能工具/Frame metrics 验收）

#### 功耗（Power）

- **NFR-POWER-001**：假设 Top5% 用户每天学习 30 分钟，学习界面相关功耗增量不超过 5mAh/天；不得持有不必要的 wakelock；音频播放仅在用户触发时进行

#### 内存（Memory）

- **NFR-MEM-001**：学习界面在展示含图片的卡片时，额外峰值内存占用 ≤ 30MB；离开学习界面后应释放与卡片相关的大对象引用（图片/音频句柄）

#### 安全与隐私（Security/Privacy）

- **NFR-SEC-001**：学习内容与学习结果仅保存在本地（符合 EPIC 隐私约束）；日志/埋点中不得记录可还原的完整释义文本（只允许记录 wordId/库Id/耗时/结果枚举）

#### 可观测性（Observability）

- **NFR-OBS-001**：必须记录关键事件：进入/退出学习界面、显示答案、提交反馈（含结果枚举、耗时）、完成会话、提交失败（含错误类型）
- **NFR-OBS-002**：崩溃或关键错误必须能定位到：当前会话类型（学习/复习）、当前题序、词库 ID（不含敏感内容）

#### 可靠性（Reliability）

- **NFR-REL-001**：学习界面 crash-free 会话率 ≥ 99.9%（以会话维度统计）；提交反馈成功率 ≥ 99.5%（排除网络/外部资源缺失导致的多媒体失败）
- **NFR-REL-002**：在进程被系统回收后重新进入学习界面，能够恢复到“同一题目”或“下一题”（不回退超过 1 题），并保持进度一致性

## 验收标准（Feature Level）*（必填）*

- **AC-001**：从入口进入学习界面后能展示第 1 张卡片且答案默认隐藏（引用 FR-001、FR-002）
- **AC-002**：显示答案后可提交认识/不认识/跳过三类反馈（引用 FR-003）
- **AC-003**：提交反馈成功后自动进入下一题并更新进度（引用 FR-004）
- **AC-004**：按钮与手势交互均可完成核心操作，且结果一致（引用 FR-005）
- **AC-005**：提交中防重复提交；提交失败停留当前题并可重试（引用 FR-006、NFR-REL-001）
- **AC-006**：完成最后一题后展示完成页并可返回（引用 FR-007）
- **AC-007**：切后台/旋转屏幕后可继续当前题并保持答案显示状态（引用 FR-008、NFR-REL-002）
- **AC-008**：有发音资源时可播放；无资源时入口置灰/隐藏且有解释（引用 FR-009）
- **AC-009**：有图片/例句时在答案显示后展示，无则不占位（引用 FR-010、NFR-MEM-001）
- **AC-010**：进入学习界面首帧 p95 ≤ 500ms，切题 UI 更新时间 p95 ≤ 100ms（引用 NFR-PERF-001）
- **AC-011**：连续学习 30 题长帧占比 ≤ 1%（引用 NFR-PERF-002）
- **AC-012**：日志/埋点不包含完整释义文本，仅包含 wordId/枚举等（引用 NFR-SEC-001、NFR-OBS-001）

## 核心实体（如涉及数据则必填）

- **学习任务（StudyTask）**：由算法引擎提供的待学习/待复习任务，至少包含 wordId、任务类型（新学/复习）、优先级/序号（如有）
- **学习会话（LearningSession）**：一次用户发起的学习过程，包含会话类型（学习/复习）、开始/结束时间、已完成数、任务集合引用
- **卡片状态（CardViewState）**：单词卡片的 UI 状态，包含“答案是否显示”、当前题序、加载状态（提交中/失败重试）
- **用户反馈（UserRating）**：用户对当前题的结果枚举（认识/不认识/跳过），用于提交给算法引擎与统计系统

## 假设与约束 *（必填）*

- **假设**：
  - **假设1**：算法引擎能提供学习任务并接受反馈；若不可用则学习界面进入空状态或允许重试（不崩溃、不丢状态）
  - **假设2**：单词基础信息（wordId、拼写、释义等）可从词库层获取；若字段缺失则按“缺省展示 + 提示”降级
  - **假设3**：多媒体资源可能缺失或失败；UI 必须可降级且不影响主学习流程

- **约束**：
  - **平台约束**：Android 8.0+（API Level 26+），Jetpack Compose
  - **交互约束**：关键操作必须同时具备可点击按钮（不强依赖手势），确保可访问性
  - **隐私约束**：学习数据不上传云端；埋点与日志不记录可还原的完整内容文本

## 需求追溯（预留，Plan 后填写）

> 说明：此表在 Plan 的 Story Breakdown 完成后填写，用于确保 FR/NFR 被 Story 覆盖；Implement 不得擅自改写 FR/NFR。

| FR/NFR ID | 计划覆盖的 Story ID（Plan） | 任务覆盖（Tasks） | 备注 |
|---|---|---|---|
| FR-001 | ST-??? | T??? |  |