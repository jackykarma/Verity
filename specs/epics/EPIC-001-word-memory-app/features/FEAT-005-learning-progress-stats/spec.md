# Feature 规格说明：学习进度与统计

**Epic**：EPIC-001 - 无痛记忆单词神器APP
**Feature 类型**：Product Feature
**Feature ID**：FEAT-005
**Feature Version**：v0.1.0
**EPIC 分支**：`epic/EPIC-001-word-memory-app`
**Feature 目录**：`specs/epics/EPIC-001-word-memory-app/features/FEAT-005-learning-progress-stats/`
**创建时间**：2026-01-19
**状态**：草稿
**输入**：用户描述：`"学习进度与统计：提供学习数据统计、报告生成和记忆曲线展示功能"`

## 背景与价值 *（必填）*

- **背景**：
  - 用户需要了解自己的学习进度和效果，以便调整学习策略和保持学习动力
  - 现有应用缺乏详细的学习数据统计和可视化展示，用户难以直观了解学习成果
  - 学习统计是用户了解学习效果的重要渠道，需要独立实现以提供完整的数据跟踪能力
  - 记忆曲线展示能够帮助用户理解间隔重复算法的效果，增强学习信心

- **目标**：
  - **用户目标**：用户能够查看详细的学习进度和统计数据，了解学习效果和记忆保持情况
  - **业务目标**：通过数据可视化提升用户学习动机和粘性，增强产品竞争力
  - **平台目标**：建立学习数据统计和分析能力，为后续个性化推荐和优化提供数据基础

- **价值**：
  - **用户价值**：用户可以直观了解学习成果，通过数据反馈调整学习策略，增强学习成就感
  - **业务价值**：通过数据展示提升用户留存率和学习时长，形成用户粘性
  - **技术价值**：建立学习数据统计框架，为后续数据分析和个性化功能提供基础

- **范围（In Scope）**：
  - 学习数据统计（学习天数、学习单词数量、复习单词数量、正确率等）
  - 学习报告生成（日报、周报、月报，包含学习时长、单词数量、正确率趋势等）
  - 记忆曲线展示（展示单词记忆强度随时间的变化趋势）
  - 学习趋势分析（学习时长趋势、单词学习量趋势、正确率趋势）
  - 基础数据可视化（图表展示统计数据，如柱状图、折线图等）

- **范围外（Out of Scope）**：
  - 详细的数据导出（不支持导出为 Excel、PDF 等格式）
  - 高级数据分析（不支持机器学习预测、个性化学习建议推荐）
  - 社交分享（不支持将统计数据分享到社交平台）
  - 多维度数据对比（不支持与其他用户或历史同期数据对比）

## 依赖关系 *（必填）*

- **上游依赖**：
  - **用户账户与数据管理（FEAT-007）**：依赖学习数据的存储和查询能力，需要获取用户学习记录、单词学习状态等数据
  - **间隔重复学习算法引擎（FEAT-002）**：依赖算法引擎提供的单词记忆强度、复习时机等数据
  - **学习界面与交互（FEAT-003）**：依赖学习操作产生的学习记录数据（学习时间、正确率等）

- **下游影响**：
  - **游戏化与激励机制（FEAT-004）**：为成就系统、积分系统提供统计数据基础（学习天数、连续学习等）
  - **用户学习行为**：统计数据展示影响用户的学习决策和学习动机

- **外部依赖故障模式**：
  - **数据库查询超时**：数据量过大导致查询超时，降级策略：限制查询时间范围，分页加载数据，显示加载提示
  - **数据统计计算耗时**：统计数据计算时间过长，降级策略：异步计算，显示计算进度，缓存计算结果
  - **图表渲染性能问题**：数据点过多导致图表渲染卡顿，降级策略：数据采样，限制显示数据点数量，使用简化图表

> 说明（重要）：若本 Feature 依赖横切能力（如"埋点/动效/算法"），建议将其作为独立的 **Capability Feature** 交付。
> - 在此明确依赖的 Capability Feature（`FEAT-xxx`）与接入契约（SDK/接口/资源包/模型版本）。
> - 业务 Feature 只描述"需要什么能力/验收口径"，不要在多个 Feature 内重复定义埋点口径、动效资产规范或算法模型细节。

## 验收与场景 *（必填）*

> 说明：本节用于"可测试"的需求验收；**不等同于技术 Story**（技术 Story 在 Plan 阶段拆分）。

### 核心用户旅程（可选但强烈建议）

#### 旅程 1 - 查看学习进度和统计数据

- **描述**：用户完成一段时间的学习后，想要查看自己的学习进度和统计数据
- **成功信号**：用户能够成功查看学习天数、学习单词数量、正确率等统计数据，数据准确可靠
- **验收场景**：
  1. **前提** 用户已完成至少 1 天的学习，**当** 用户进入统计页面，**则** 系统显示学习天数、学习单词数量、复习单词数量、平均正确率等统计数据
  2. **前提** 用户已完成多天学习，**当** 用户查看学习趋势图表，**则** 系统显示学习时长、单词学习量、正确率的趋势变化

#### 旅程 2 - 查看记忆曲线

- **描述**：用户想要了解自己学习的单词记忆强度随时间的变化情况
- **成功信号**：用户能够查看记忆曲线图表，了解单词记忆强度的变化趋势
- **验收场景**：
  1. **前提** 用户已学习多个单词并完成多次复习，**当** 用户进入记忆曲线页面，**则** 系统显示单词记忆强度随时间的变化曲线
  2. **前提** 用户查看特定单词的记忆曲线，**当** 用户选择某个单词，**则** 系统显示该单词的记忆强度变化历史

#### 旅程 3 - 生成和查看学习报告

- **描述**：用户想要查看详细的学习报告，了解一段时间内的学习情况
- **成功信号**：用户能够成功生成并查看日报、周报或月报，报告内容完整准确
- **验收场景**：
  1. **前提** 用户已完成当天的学习，**当** 用户点击生成日报，**则** 系统生成包含当天学习时长、单词数量、正确率等信息的日报
  2. **前提** 用户已完成一周的学习，**当** 用户选择生成周报，**则** 系统生成包含本周学习天数、总学习时长、单词学习量、正确率趋势等信息的周报

### 边界与异常场景（必填）

- **无学习数据** → 显示空状态提示，引导用户开始学习，说明统计数据将在学习后生成
- **数据量过大导致查询超时** → 限制查询时间范围（如最多查询 3 个月数据），分页加载，显示加载提示和进度
- **统计数据计算耗时过长** → 异步计算统计数据，显示计算进度，缓存计算结果避免重复计算
- **图表数据点过多导致渲染卡顿** → 数据采样（如每 10 个数据点取 1 个），限制显示数据点数量（最多 100 个点），使用简化图表
- **数据库查询失败** → 显示错误提示，允许用户重试，记录错误日志便于排查
- **内存不足导致图表渲染失败** → 降级为简化图表（如文本列表），提示用户清理内存或重启应用
- **时间范围选择无效** → 用户选择的时间范围无数据时，显示提示信息，建议选择其他时间范围
- **并发访问统计数据** → 支持多个用户同时查看统计数据，使用缓存减少数据库查询压力

## FR / NFR *（必填）*

### FR（Functional Requirements）

> 规则：每条 FR 必须**可测试**，避免"提升体验/更快/更稳定"这类不可验证表述。

- **FR-001**：用户必须能够查看学习天数、学习单词数量、复习单词数量、平均正确率等基础统计数据
- **FR-002**：用户必须能够查看学习时长趋势、单词学习量趋势、正确率趋势等学习趋势图表
- **FR-003**：用户必须能够查看记忆曲线，展示单词记忆强度随时间的变化趋势
- **FR-004**：用户必须能够生成和查看日报、周报、月报，报告必须包含学习时长、单词数量、正确率等关键信息
- **FR-005**：用户必须能够选择时间范围查看统计数据（如最近 7 天、30 天、90 天）
- **FR-006**：系统必须在无学习数据时显示空状态提示，引导用户开始学习
- **FR-007**：系统必须在统计数据计算或加载时显示加载提示，避免用户等待时无反馈
- **FR-008**：用户必须能够查看单个单词的记忆曲线，了解该单词的记忆强度变化历史

### NFR（Non-Functional Requirements）

> 规则：每条 NFR 必须**量化**并附带验收方式；细化评估在 Plan 阶段完成。

#### 性能（Performance）

- **NFR-PERF-001**：统计数据页面加载时间不超过 1 秒（p95），图表渲染时间不超过 500ms（p95），报告生成时间不超过 2 秒（p95）
- **NFR-PERF-002**：数据查询超时时，降级策略：限制查询时间范围（最多 3 个月），分页加载数据，显示加载提示
- **NFR-PERF-003**：图表数据点过多时，降级策略：数据采样（每 10 个点取 1 个），限制显示数据点数量（最多 100 个），使用简化图表

#### 功耗（Power）

- **NFR-POWER-001**：假设 Top5% 用户每天查看统计数据 5 次，每次查看 2 分钟，学习统计功能每日电池消耗增量不超过 10mAh（主要来自图表渲染和数据查询）

#### 内存（Memory）

- **NFR-MEM-001**：统计数据页面内存占用峰值不超过 50MB（包含图表数据和渲染缓存），统计数据计算完成后立即释放临时数据
- **NFR-MEM-002**：图表数据生命周期：页面退出时清理图表数据和缓存，下次进入时重新加载

#### 安全与隐私（Security/Privacy）

- **NFR-SEC-001**：学习统计数据仅存储在本地设备，不上传云端；统计数据访问不需要额外权限（符合 EPIC 隐私要求）
- **NFR-SEC-002**：统计数据展示不包含敏感信息（如具体学习时间点、学习内容详情），仅展示聚合统计数据

#### 可观测性（Observability）

- **NFR-OBS-001**：记录统计数据查看事件（页面类型、时间范围、查看时长）；记录报告生成事件（报告类型、生成耗时、是否成功）
- **NFR-OBS-002**：统计数据查询失败时记录错误日志（错误类型、查询参数、错误详情），便于问题排查
- **NFR-OBS-003**：记录图表渲染性能指标（渲染耗时、数据点数量、是否降级），用于性能优化

#### 可靠性（Reliability）

- **NFR-REL-001**：统计数据查询成功率不低于 99.5%，报告生成成功率不低于 99%，图表渲染成功率不低于 99%
- **NFR-REL-002**：统计数据准确性：统计数据必须与学习记录数据一致，误差不超过 0.1%
- **NFR-REL-003**：数据持久化：统计数据计算结果可缓存，避免重复计算，缓存失效时间不超过 1 小时

## 验收标准（Feature Level）*（必填）*

- **AC-001**：用户能够查看学习天数、学习单词数量、复习单词数量、平均正确率等基础统计数据（引用 FR-001）
- **AC-002**：用户能够查看学习时长趋势、单词学习量趋势、正确率趋势等学习趋势图表（引用 FR-002）
- **AC-003**：用户能够查看记忆曲线，展示单词记忆强度随时间的变化趋势（引用 FR-003）
- **AC-004**：用户能够生成和查看日报、周报、月报，报告包含学习时长、单词数量、正确率等关键信息（引用 FR-004）
- **AC-005**：用户能够选择时间范围查看统计数据（引用 FR-005）
- **AC-006**：无学习数据时显示空状态提示（引用 FR-006）
- **AC-007**：统计数据计算或加载时显示加载提示（引用 FR-007）
- **AC-008**：用户能够查看单个单词的记忆曲线（引用 FR-008）
- **AC-009**：统计数据页面加载时间不超过 1 秒（p95）（引用 NFR-PERF-001）
- **AC-010**：图表渲染时间不超过 500ms（p95）（引用 NFR-PERF-001）
- **AC-011**：报告生成时间不超过 2 秒（p95）（引用 NFR-PERF-001）
- **AC-012**：统计数据页面内存占用峰值不超过 50MB（引用 NFR-MEM-001）
- **AC-013**：统计数据查询成功率不低于 99.5%（引用 NFR-REL-001）
- **AC-014**：统计数据准确性误差不超过 0.1%（引用 NFR-REL-002）

## 核心实体（如涉及数据则必填）

- **学习统计（LearningStatistics）**：表示用户的学习统计数据，包含学习天数、学习单词数量、复习单词数量、平均正确率、总学习时长等；一个用户对应一个学习统计记录，按时间维度聚合
- **学习报告（LearningReport）**：表示一个学习报告，包含报告类型（日报/周报/月报）、时间范围、学习时长、单词数量、正确率趋势等；一个用户可以有多个学习报告，按时间范围生成
- **记忆曲线数据（MemoryCurveData）**：表示单词记忆强度随时间的变化数据，包含单词 ID、时间点、记忆强度值；一个单词对应多条记忆曲线数据点，按时间排序
- **学习趋势数据（LearningTrendData）**：表示学习趋势数据，包含时间点、学习时长、单词学习量、正确率等；按时间维度聚合，用于趋势图表展示

## 假设与约束 *（必填）*

- **假设**：
  - **假设1**：用户已完成至少 1 天的学习，产生学习记录数据，若用户无学习数据，显示空状态提示
  - **假设2**：学习记录数据存储在本地数据库中，可正常查询，若数据库查询失败，显示错误提示并允许重试
  - **假设3**：设备有足够的内存用于图表渲染（至少 50MB），若内存不足，降级为简化图表
  - **假设4**：统计数据计算时间在可接受范围内（不超过 2 秒），若计算耗时过长，异步计算并显示进度

- **约束**：
  - **平台约束**：Android 8.0+（API Level 26+），使用 Jetpack Compose 进行图表渲染
  - **数据约束**：统计数据查询时间范围不超过 1 年，单次查询数据量不超过 10 万条记录
  - **性能约束**：图表数据点数量不超过 100 个，超过时进行数据采样
  - **存储约束**：统计数据缓存大小不超过 10MB，缓存失效时间不超过 1 小时

## 需求追溯（预留，Plan 后填写）

> 说明：此表在 Plan 的 Story Breakdown 完成后填写，用于确保 FR/NFR 被 Story 覆盖；Implement 不得擅自改写 FR/NFR。

| FR/NFR ID | 计划覆盖的 Story ID（Plan） | 任务覆盖（Tasks） | 备注 |
|---|---|---|---|
| FR-001 | ST-??? | T??? |  |
| FR-002 | ST-??? | T??? |  |
| FR-003 | ST-??? | T??? |  |
| FR-004 | ST-??? | T??? |  |
| FR-005 | ST-??? | T??? |  |
| FR-006 | ST-??? | T??? |  |
| FR-007 | ST-??? | T??? |  |
| FR-008 | ST-??? | T??? |  |
