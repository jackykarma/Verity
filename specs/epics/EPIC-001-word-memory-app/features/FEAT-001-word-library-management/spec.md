# Feature 规格说明：单词库管理

**Epic**：EPIC-001 - 无痛记忆单词神器APP
**Feature 类型**：Product Feature
**Feature ID**：FEAT-001
**Feature Version**：v0.1.0
**EPIC 分支**：`epic/EPIC-001-word-memory-app`
**Feature 目录**：`specs/epics/EPIC-001-word-memory-app/features/FEAT-001-word-library-management/`
**创建时间**：2026-01-18
**状态**：草稿
**输入**：用户描述：`"单词库管理：支持词库导入、列表展示、选择和搜索功能"`

## 背景与价值 *（必填）*

- **背景**：
  - 用户需要导入和管理单词词库作为学习内容的基础数据源
  - 现有应用缺乏灵活的词库管理能力，用户难以选择和管理多个词库
  - 词库管理是学习功能的基础支撑，需要独立交付以确保学习功能有稳定的数据来源

- **目标**：
  - **用户目标**：用户能够轻松导入、查看、选择和管理多个单词词库
  - **业务目标**：建立词库管理能力，为后续学习功能提供稳定的数据基础
  - **平台目标**：建立可扩展的词库管理框架，支持未来扩展更多词库格式和来源

- **价值**：
  - **用户价值**：用户可以灵活选择学习内容，管理个人词库集合，提升学习个性化
  - **业务价值**：为产品提供词库管理能力，支撑核心学习功能
  - **技术价值**：建立词库数据模型和管理框架，为后续功能提供数据基础

- **范围（In Scope）**：
  - 词库文件导入（支持常见格式如 JSON、CSV、TXT 等）
  - 词库列表展示（显示已导入的词库列表）
  - 词库选择/切换（用户可以选择要使用的词库）
  - 词库搜索（在词库列表中搜索词库）
  - 词库基本信息查看（显示词库名称、单词数量、创建时间等）

- **范围外（Out of Scope）**：
  - 词库编辑（仅支持导入，不支持编辑词库内容）
  - 词库在线同步（第一阶段仅支持本地导入）
  - 自定义词库创建（不支持用户手动创建词库）
  - 词库内容预览（不支持查看词库内单词详情）

## 依赖关系 *（必填）*

- **上游依赖**：
  - **词库资源**：需要获取或准备单词词库文件（包含单词、音标、释义等基础信息）
  - **Android 平台**：文件系统访问权限、文件选择器 API
  - **用户账户与数据管理（FEAT-007）**：词库元数据存储和查询（可选，第一阶段可先使用简单存储）

- **下游影响**：
  - **间隔重复学习算法引擎（FEAT-002）**：依赖词库数据作为学习内容来源
  - **多媒体支持（FEAT-006）**：依赖词库中的多媒体资源（音频、图片、例句）
  - **学习界面与交互（FEAT-003）**：依赖当前选中的词库进行学习

- **外部依赖故障模式**：
  - **文件系统访问失败**：用户拒绝文件访问权限时，提示用户授权并引导设置
  - **词库文件格式错误**：导入失败时，显示明确的错误提示，说明支持的格式和文件要求
  - **存储空间不足**：词库导入时存储空间不足，提示用户清理空间或选择较小的词库
  - **词库文件损坏**：文件读取失败时，提示用户重新导入或选择其他词库

> 说明（重要）：若本 Feature 依赖横切能力（如“埋点/动效/算法”），建议将其作为独立的 **Capability Feature** 交付。
> - 在此明确依赖的 Capability Feature（`FEAT-xxx`）与接入契约（SDK/接口/资源包/模型版本）。
> - 业务 Feature 只描述“需要什么能力/验收口径”，不要在多个 Feature 内重复定义埋点口径、动效资产规范或算法模型细节。

## 验收与场景 *（必填）*

> 说明：本节用于“可测试”的需求验收；**不等同于技术 Story**（技术 Story 在 Plan 阶段拆分）。

### 核心用户旅程（可选但强烈建议）

#### 旅程 1 - 导入并选择词库

- **描述**：用户首次使用应用，需要导入单词词库并选择要学习的词库
- **成功信号**：用户成功导入词库并在词库列表中选择了一个词库作为当前学习词库
- **验收场景**：
  1. **前提** 应用首次启动，无任何词库，**当** 用户点击"导入词库"按钮并选择词库文件，**则** 系统解析文件并显示词库基本信息，词库出现在列表中
  2. **前提** 词库列表中有多个词库，**当** 用户点击某个词库，**则** 该词库被标记为"当前使用"，其他词库显示为"未使用"

#### 旅程 2 - 搜索和管理词库

- **描述**：用户已导入多个词库，需要快速找到特定词库或切换词库
- **成功信号**：用户能够通过搜索快速找到目标词库，并成功切换当前使用的词库
- **验收场景**：
  1. **前提** 词库列表中有 5 个词库，**当** 用户在搜索框输入词库名称关键词，**则** 列表实时过滤显示匹配的词库
  2. **前提** 当前使用词库 A，**当** 用户选择词库 B，**则** 词库 B 被设置为当前使用，词库 A 变为未使用状态

### 边界与异常场景（必填）

- **空词库列表** → 显示空状态提示，引导用户导入第一个词库
- **词库文件格式不支持** → 显示错误提示，说明支持的格式（JSON、CSV、TXT），提供格式示例链接
- **词库文件过大（>50MB）** → 提示用户文件过大可能影响性能，询问是否继续导入
- **词库文件解析失败** → 显示明确的错误信息，说明失败原因（格式错误、编码问题等），允许用户重新选择文件
- **存储空间不足** → 检测到存储空间不足时，提示用户清理空间，阻止导入操作
- **文件权限被拒绝** → 引导用户到系统设置中授予文件访问权限，提供设置入口
- **并发导入多个词库** → 支持队列处理，逐个导入，显示导入进度，避免内存溢出
- **应用退出时正在导入** → 保存导入进度，下次启动时继续或提示用户重新导入

## FR / NFR *（必填）*

### FR（Functional Requirements）

> 规则：每条 FR 必须**可测试**，避免“提升体验/更快/更稳定”这类不可验证表述。

- **FR-001**：用户必须能够从文件系统导入词库文件，系统必须支持至少 JSON、CSV、TXT 三种格式
- **FR-002**：用户必须能够查看已导入的词库列表，列表中必须显示词库名称、单词数量、创建时间
- **FR-003**：用户必须能够从词库列表中选择一个词库作为当前学习词库，系统必须标记当前使用的词库
- **FR-004**：用户必须能够在词库列表中搜索词库，搜索必须基于词库名称进行模糊匹配
- **FR-005**：系统必须在词库导入失败时向用户显示明确的错误信息，说明失败原因
- **FR-006**：系统必须在词库列表为空时显示空状态提示，引导用户导入第一个词库

### NFR（Non-Functional Requirements）

> 规则：每条 NFR 必须**量化**并附带验收方式；细化评估在 Plan 阶段完成。

#### 性能（Performance）

- **NFR-PERF-001**：词库列表加载时间不超过 500ms（p95），词库搜索响应时间不超过 200ms（p95），词库导入（10MB 文件）不超过 5 秒
- **NFR-PERF-002**：词库文件解析失败时，降级策略：显示错误提示，允许用户重新选择文件

#### 功耗（Power）

- **NFR-POWER-001**：假设 Top5% 用户每天导入 3 个词库（每个 5MB），词库管理功能每日电池消耗增量不超过 5mAh（主要来自文件 I/O 操作）

#### 内存（Memory）

- **NFR-MEM-001**：词库列表内存占用峰值不超过 20MB（假设 10 个词库，每个词库元数据约 2MB），词库导入完成后立即释放解析过程中的临时内存
- **NFR-MEM-002**：词库列表生命周期：应用退出时清理内存中的词库列表数据，下次启动时从存储重新加载

#### 安全与隐私（Security/Privacy）

- **NFR-SEC-001**：词库文件存储在应用私有目录，不与其他应用共享；仅在用户明确授权时访问外部存储；词库内容不上传云端（符合 EPIC 隐私要求）
- **NFR-SEC-002**：文件访问权限：使用 Android Storage Access Framework，不申请全局存储权限

#### 可观测性（Observability）

- **NFR-OBS-001**：记录词库导入成功/失败事件（词库名称、文件大小、格式、耗时）；记录词库选择事件（词库 ID、切换前后状态）；记录搜索事件（关键词、结果数量）
- **NFR-OBS-002**：词库导入失败时记录错误日志（错误类型、文件路径、错误详情），便于问题排查

#### 可靠性（Reliability）

- **NFR-REL-001**：词库导入成功率不低于 99%（排除格式不支持的情况）；词库列表加载成功率 100%；词库选择操作成功率 100%
- **NFR-REL-002**：词库数据持久化：应用崩溃或退出时，已导入的词库列表和当前选择状态必须保存，重启后恢复

## 验收标准（Feature Level）*（必填）*

- **AC-001**：用户能够成功导入 JSON、CSV、TXT 格式的词库文件，词库出现在列表中（引用 FR-001）
- **AC-002**：词库列表正确显示词库名称、单词数量、创建时间（引用 FR-002）
- **AC-003**：用户能够选择词库作为当前学习词库，当前词库被正确标记（引用 FR-003）
- **AC-004**：用户能够通过搜索框搜索词库，搜索结果实时更新（引用 FR-004）
- **AC-005**：词库导入失败时显示明确的错误信息（引用 FR-005）
- **AC-006**：词库列表为空时显示空状态提示（引用 FR-006）
- **AC-007**：词库列表加载时间不超过 500ms（p95）（引用 NFR-PERF-001）
- **AC-008**：词库搜索响应时间不超过 200ms（p95）（引用 NFR-PERF-001）
- **AC-009**：词库列表内存占用峰值不超过 20MB（引用 NFR-MEM-001）
- **AC-010**：词库数据正确持久化，应用重启后恢复（引用 NFR-REL-002）

## 核心实体（如涉及数据则必填）

- **词库（WordLibrary）**：表示一个单词词库，包含词库 ID、名称、单词数量、创建时间、文件路径、当前使用状态；一个用户可以有多个词库，但只有一个词库被标记为"当前使用"
- **词库元数据（LibraryMetadata）**：词库的元数据信息，包含词库 ID、名称、单词数量、创建时间、文件格式、文件大小；用于列表展示，不包含词库内单词详情

## 假设与约束 *（必填）*

- **假设**：
  - **假设1**：词库文件格式符合规范（JSON 包含单词列表字段，CSV 包含单词列），若格式不规范，导入失败并提示用户
  - **假设2**：设备有足够的存储空间（至少 50MB）用于词库文件存储，若存储不足，阻止导入并提示用户清理空间
  - **假设3**：用户授予文件系统访问权限，若权限被拒绝，引导用户到设置中授权
  - **假设4**：词库文件编码为 UTF-8，若编码不支持，尝试自动检测或提示用户

- **约束**：
  - **平台约束**：Android 8.0+（API Level 26+），使用 Storage Access Framework 访问文件
  - **格式约束**：词库文件大小不超过 50MB，支持 JSON、CSV、TXT 格式
  - **存储约束**：词库文件存储在应用私有目录，不占用用户可见存储空间
  - **兼容性约束**：词库文件格式必须符合预定义的 JSON/CSV 结构规范

## 需求追溯（预留，Plan 后填写）

> 说明：此表在 Plan 的 Story Breakdown 完成后填写，用于确保 FR/NFR 被 Story 覆盖；Implement 不得擅自改写 FR/NFR。

| FR/NFR ID | 计划覆盖的 Story ID（Plan） | 任务覆盖（Tasks） | 备注 |
|---|---|---|---|
| FR-001 | ST-??? | T??? |  |