# Feature 规格说明：单词记忆系统

**Epic**：EPIC-002 - Android 端英语学习 APP
**Feature 类型**：Product Feature
**Feature ID**：FEAT-001
**Feature Version**：v0.1.0
**EPIC 分支**：`epic/EPIC-002-android-english-learning`
**Feature 目录**：`specs/epics/EPIC-002-android-english-learning/features/FEAT-001-word-memory/`
**创建时间**：2026-01-25
**状态**：草稿
**输入**：用户描述：`"单词记忆系统：词库与词单、识记、复习与进度管理，单词发音需遵循设置中的英式/美式偏好。"`

## 背景与价值 *（必填）*

- **背景**：背词是英语学习的高频刚需；用户需要词库/词单选词、识记、复习与进度反馈的完整闭环，且单词发音需与个人口音偏好（英式/美式）一致。
- **目标**：在单机内交付可独立使用的单词记忆能力：词库与词单管理、识记流程、复习与简易遗忘曲线（或等效复习策略）、学习进度与统计；单词发音播放遵循设置中的英式/美式偏好。
- **价值**：为学习者提供一站式背词体验，提升留存与记忆效率；发音与全局设置一致，减少认知负担。
- **范围（In Scope）**：词库或预置词单、词单选择与学习目标设定；识记流程（释义展示、发音、自评认识/不认识）；复习流程与复习调度（简易遗忘曲线或按日复习）；学习进度、已学/待复习数量与统计；单词发音播放，且严格遵循设置中的英式/美式发音偏好。
- **范围外（Out of Scope）**：词库的云端同步、UGC 词单、跨设备同步；具体遗忘曲线算法实现放在 Feature 内 spec/Plan，但不由本 spec 规定具体模型。

## 澄清内容

### 会话 2026-01-25

- 问题：词库与词单的规模假设（单词单最大词数、词库总词数或首版范围）是否需要在 spec 中写死？ → 答案：首版不设硬性上限，完全由 Plan 根据实现与性能定。
- 问题：学习记录的终态与「掌握」：是否要定义「掌握/已毕业」（后续不再安排复习）？若需要，采用哪种规则？ → 答案：连续 N 次在复习中选「认识」则视为掌握，之后不再安排复习（N 由 Plan 定，如 2 或 3）。
- 问题：进入识记或复习时，若需从本地/词库加载数据，是否必须提供明确的加载态（如 skeleton、loading）？ → 答案：必须提供加载态（skeleton 或 loading 等），禁止长时间白屏。
- 问题：用户连续快速点击「单词发音」时，是否需要对发音做防抖/节流？ → 答案：防抖或节流（如 300ms 内只播一次，或等当前播完再播下一词）。

## 依赖关系 *（必填）*

- **上游依赖**：**设置 Feature**（发音偏好英式/美式的持久化与查询接口）；系统 TTS 或第三方语音引擎（调用时传入英/美参数，由本 Feature 按设置读取偏好后传入）；本地存储。
- **下游影响**：无（本 Feature 为业务端能力，被首页/导航引用）。
- **外部依赖故障模式**：TTS/语音不可用或超时时，单词发音降级为不播放或提示「发音暂不可用」；设置未就绪时，发音偏好缺省为美式；本地存储不可用时，进度与统计数据无法持久化，需提示并允许仅本次会话使用。

> 说明（重要）：若本 Feature 依赖横切能力（如“埋点/动效/算法”），建议将其作为独立的 **Capability Feature** 交付。
> - 在此明确依赖的 Capability Feature（`FEAT-xxx`）与接入契约（SDK/接口/资源包/模型版本）。
> - 业务 Feature 只描述“需要什么能力/验收口径”，不要在多个 Feature 内重复定义埋点口径、动效资产规范或算法模型细节。

## 验收与场景 *（必填）*

> 说明：本节用于“可测试”的需求验收；**不等同于技术 Story**（技术 Story 在 Plan 阶段拆分）。

### 核心用户旅程（可选但强烈建议）

#### 旅程 1 - 选词并开始识记

- **描述**：用户从词库或词单中选择要学习的内容，设定每日目标，进入识记流程，看到释义与发音按钮，可自评认识/不认识。
- **成功信号**：用户完成至少一个词单的首次识记，并能在界面看到进度变化。
- **验收场景**：
  1. **前提** 已安装并打开单词模块，**当** 用户选择某词单并设置每日新词数量，**则** 进入识记流程，按设定数量展示新词，每条可看释义、点发音（遵循设置中的英/美偏好）、自评认识/不认识。
  2. **前提** 识记进行中，**当** 用户点击单词发音，**则** 播放该词发音，口音与设置中的英式或美式一致。

#### 旅程 2 - 复习与进度查看

- **描述**：用户根据复习提醒或主动进入复习，完成待复习单词；在进度/统计处查看已学、待复习、连续天数等。
- **成功信号**：用户完成一次复习会话，并能在统计中看到已学数量与待复习数量的更新。
- **验收场景**：
  1. **前提** 存在待复习单词，**当** 用户进入复习，**则** 按复习调度展示待复习词，支持发音（遵循设置偏好）与自评，完成后更新待复习数与统计。
  2. **前提** 用户在单词模块，**当** 用户打开进度/统计页，**则** 展示已学总数、待复习数、连续学习天数等可理解指标。

### 边界与异常场景（必填）

- 词单为空或所选词单无可学词 → 明确提示「暂无新词」或「请选择其他词单」，不进入识记。
- 进入识记或复习且需从存储/词库加载时 → 必须展示加载态（skeleton 或 loading），禁止长时间白屏。
- 用户连续快速点击发音 → 系统须对发音请求做防抖或节流（如 300ms 内只播一次，或等当前播放结束再播下一词），具体策略由 Plan 确定。
- 发音引擎不可用或超时 → 不播放或 toast「发音暂不可用」，不阻塞识记/复习流程。
- 设置中发音偏好未初始化（首装或数据缺失）→ 缺省按美式发音调用；设置就绪后下次播放起遵循新偏好。
- 应用在识记/复习中途被 kill 或崩溃 → 已提交的自评与进度尽力持久化；恢复后可从断点或最近进度继续，不重复计学/计复习。
- 本地存储满或不可写 → 提示「无法保存进度」，允许仅本次会话内使用，退出后进度不保留。

## FR / NFR *（必填）*

### FR（Functional Requirements）

> 规则：每条 FR 必须**可测试**，避免“提升体验/更快/更稳定”这类不可验证表述。

- **FR-001**：用户必须能够从词库或预置词单中选择要学习的词单，并设定每日新词数量（或等效学习量）；系统必须按该设定控制单次识记的新词数量。
- **FR-002**：用户必须能够在识记流程中查看单词拼写、释义（及可选音标、例句），并可通过按钮触发单词发音；发音必须使用设置中持久化的英式或美式偏好（若设置为英式则英式，美式则美式）。
- **FR-003**：用户必须能够在识记中对每个新词做出「认识」或「不认识」的自评；系统必须根据自评结果将单词纳入复习调度（不认识或模糊的可优先或更早复习）。
- **FR-004**：用户必须能够进入复习流程，按复习调度看到待复习单词，并对其再次自评认识/不认识；系统必须根据复习自评更新该词的下次复习时间或掌握状态；当某词在复习中连续 N 次自评「认识」时，系统必须将其标记为掌握并移出复习池，N 由 Plan 确定。
- **FR-005**：用户必须能够查看学习进度与统计，至少包含：已学新词总数、当前待复习数量、连续学习天数（或等效统计）；数据必须来源于本机持久化，且在应用重启后仍正确。
- **FR-006**：系统必须在 TTS/发音可用且设置就绪时，对单词发音请求按设置中的英式/美式偏好调用引擎；若设置切换，则下次播放起立即生效，无需重启应用。
- **FR-007**：进入识记或复习且需从本地/词库加载数据时，系统必须展示加载态（skeleton 或 loading 等），禁止长时间白屏。
- **FR-008**：用户连续快速点击单词发音时，系统必须对发音请求做防抖或节流（如 300ms 内只响应一次，或等当前播放结束再响应下一次），具体策略由 Plan 确定。

### NFR（Non-Functional Requirements）

> 规则：每条 NFR 必须**量化**并附带验收方式；细化评估在 Plan 阶段完成。

#### 性能（Performance）

- **NFR-PERF-001**：识记/复习单卡切换（含释义渲染、发音按钮可用）在前台 p95 ≤ 500ms（中端机）；发音开始播放的端到端延迟 ≤ 2s（与 EPIC-NFR-PERF-002 一致）；若 TTS 超时则降级为不播放并可选 toast，不阻塞翻卡。

#### 功耗（Power）

- **NFR-POWER-001**：在典型单次会话（约 15 分钟识记+复习）下，功耗增量在可接受范围内；后台无持续轮询或长连接；[需澄清：Top5% 用户每日 mAh 增量与触发频次在 Plan 阶段细化]。

#### 内存（Memory）

- **NFR-MEM-001**：单词模块会话内内存增量 ≤ 80MB（相对进入前基线，中端机）；词库/词单与进度数据按需加载，不一次性全量驻留；退出模块或进程回收后内存可释放，符合 EPIC-NFR-MEM-001 的 300MB 会话总约束。

#### 安全与隐私（Security/Privacy）

- **NFR-SEC-001**：学习数据（进度、自评、词单选择）仅存于本机，不未经同意上传；遵循 EPIC-NFR-SEC-001 的权限与最小范围原则；若未来扩展同步，须单独合规设计。

#### 可观测性（Observability）

- **NFR-OBS-001**：首版至少记录崩溃与模块进入/退出；发音失败、TTS 超时可打点或日志，便于排查；产品埋点可按迭代补充，与 EPIC-NFR-OBS-001 一致。

#### 可靠性（Reliability）

- **NFR-REL-001**：自评与进度写入采用尽力持久化；应用异常退出后，再次进入可恢复最近一致状态，不出现「已学/已复习」大量回滚；词库/词单资源损坏时，可提示并降级，不导致模块不可用。

## 验收标准（Feature Level）*（必填）*

- **AC-001**：用户完成「选词单 → 设目标 → 识记（含发音与自评）→ 复习 → 查看进度」闭环，且发音与设置中的英式/美式一致。【FR-001～FR-006】
- **AC-002**：在设置中切换英式/美式后，单词发音在下次播放或当次会话内新触发的播放中生效，无需重启应用。【FR-006】
- **AC-003**：识记/复习单卡切换 p95 ≤ 500ms，发音开始播放 ≤ 2s；TTS 不可用时有不播放或提示的降级，不阻塞流程。【NFR-PERF-001】
- **AC-004**：单词模块会话内内存增量 ≤ 80MB，退出后可释放。【NFR-MEM-001】
- **AC-005**：进度与统计在重启后正确展示；异常退出后再次进入可恢复，无大量回滚。【NFR-REL-001、FR-005】
- **AC-006**：学习数据仅存本机，不未经同意上传。【NFR-SEC-001】
- **AC-007**：进入识记或复习且存在数据加载时，界面展示加载态，无长时间白屏。【FR-007】
- **AC-008**：用户连续快速点击发音时，系统对发音请求做防抖或节流，无重复触发或 ANR。【FR-008】

## 核心实体（如涉及数据则必填）

- **词库（WordBank）**：预置单词集合的元数据与索引；核心属性：词库 ID、名称、词条数量、可选标签；关系：包含多条词单或直接作为默认词单。
- **词单（WordList）**：可被用户选择的学习单位；核心属性：词单 ID、名称、词条数、来源词库；关系：包含多个单词，用于识记与复习的筛选范围。
- **单词（Word）**：单条词条；核心属性：拼写、释义、音标（可选）、例句（可选）、词性；关系：属于某词单，对应多条学习记录。
- **学习记录（LearningRecord）**：用户对某词在识记/复习中的自评与时间；核心属性：用户对词的单向关联、首次学习时间、最近自评（认识/不认识）、下次复习时间或调度状态、掌握状态；关系：多对一指向单词。掌握规则：连续 N 次在复习中选「认识」则进入掌握，之后不再安排复习；N 由 Plan 确定（如 2 或 3）。
- **进度与统计（Progress）**：聚合数据；核心属性：已学新词总数、待复习数量、连续学习天数、最近学习日期；关系：按用户/本机聚合，来源于学习记录。

## 假设与约束 *（必填）*

- **假设**：设置 Feature 先于或与本 Feature 同期交付，且提供发音偏好键的读取接口；设备具备 TTS 或可用的发音引擎，并支持英/美参数；用户具备基本识字与自评能力；词库/词单资源随应用打包或首次使用可拉取，不依赖实时网络。若 TTS 长期不可用，用户可接受仅文本识记。
- **约束**：Android 8.0+ / API 26+；发音与 EPIC 的「发音偏好与语音使用规范」一致，不单独实现 TTS 选型；词库云端同步、UGC、跨设备不在本 Feature 范围；具体遗忘曲线或复习算法在 Plan 阶段选定并实现，本 spec 仅约定「存在复习调度与下次复习时间」的语义。词库与词单的规模（单词单最大词数、词库总词数）不在本 spec 规定硬性上限，由 Plan 根据实现与性能确定。掌握规则：连续 N 次在复习中选「认识」则视为掌握、不再安排复习，N 由 Plan 确定。

## 需求追溯（预留，Plan 后填写）

> 说明：此表在 Plan 的 Story Breakdown 完成后填写，用于确保 FR/NFR 被 Story 覆盖；Implement 不得擅自改写 FR/NFR。

| FR/NFR ID | 计划覆盖的 Story ID（Plan） | 任务覆盖（Tasks） | 备注 |
|---|---|---|---|
| FR-001 | ST-??? | T??? |  |
| FR-002 | ST-??? | T??? |  |
| FR-003 | ST-??? | T??? |  |
| FR-004 | ST-??? | T??? |  |
| FR-005 | ST-??? | T??? |  |
| FR-006 | ST-??? | T??? |  |
| FR-007 | ST-??? | T??? |  |
| FR-008 | ST-??? | T??? |  |
| NFR-PERF-001 | ST-??? | T??? |  |
| NFR-POWER-001 | ST-??? | T??? |  |
| NFR-MEM-001 | ST-??? | T??? |  |
| NFR-SEC-001 | ST-??? | T??? |  |
| NFR-OBS-001 | ST-??? | T??? |  |
| NFR-REL-001 | ST-??? | T??? |  |

## 变更记录（增量变更）

| 版本 | 日期 | 变更范围 | 变更摘要 | 影响 | 是否需要回滚 |
|---|---|---|---|---|---|
| v0.1.0 | 2026-01-25 | 全文 | 初始版本 | — | 否 |
