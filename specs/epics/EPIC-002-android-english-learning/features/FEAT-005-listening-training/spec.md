# Feature 规格说明：听力训练

**Epic**：EPIC-002 - Android 端英语学习 APP
**Feature 类型**：Product Feature
**Feature ID**：FEAT-005
**Feature Version**：v0.1.0
**EPIC 分支**：`epic/EPIC-002-android-english-learning`
**Feature 目录**：`specs/epics/EPIC-002-android-english-learning/features/FEAT-005-listening-training/`
**创建时间**：2026-01-25
**状态**：草稿
**输入**：用户描述：`"听力训练：听力材料播放、题目或练习、结果反馈；音频发音需支持并遵循设置中的英式/美式偏好。"`

## 背景与价值 *（必填）*

- **背景**：用户需要通过听写、理解题等形式提升英语听力；输入型训练与阅读、口语形成闭环，发音偏好（英/美）需在各模块一致。
- **目标**：用户可选取听力材料、完成播放与配套题目/练习，并获得结果与反馈；材料或 TTS 的发音遵循设置中的英式/美式偏好。
- **价值**：提供可离线使用的听力训练能力，满足备考与泛听场景；与设置中的发音偏好联动，提升学习一致性与体验。
- **范围（In Scope）**：听力材料（音频 + 题目/练习）、播放控制、答题或跟听、结果与反馈；音频发音支持并遵循设置中的英式/美式偏好。
- **范围外（Out of Scope）**：听力材料的 UGC、实时流式音频、多人口语识别； TTS/语音引擎的选型与实现归属能力层或本 Feature 的实现细节。

## 依赖关系 *（必填）*

- **上游依赖**：设置 Feature（发音偏好英式/美式的持久化与查询）；系统 TTS 或第三方语音引擎（若材料含合成语音）；本地或资产包中的音频与题目数据。
- **下游影响**：无；与单词、阅读、口语并列，共同贡献 EPIC 端到端验收（如 E2E-002）。
- **外部依赖故障模式**：TTS/语音不可用或超时时，合成部分降级为仅文本或提示用户；本地音频损坏或缺失时，提示并跳过该材料。

## 验收与场景 *（必填）*

### 核心用户旅程（可选但强烈建议）

#### 旅程 1 - 完成一次听力练习

- **描述**：用户进入听力训练，选择一份材料，听音频并完成题目或练习，提交后查看对错与反馈。
- **成功信号**：用户看到本次练习的结果（如正确率、错题或解析），且所听发音与设置中的英/美偏好一致（在材料支持的前提下）。
- **验收场景**：
  1. **前提** 已有听力材料与题目，**当** 用户播放音频并答题后提交，**则** 展示结果与反馈（对错、得分或解析）。
  2. **前提** 设置中为英式发音，**当** 播放依赖 TTS 或可切换口音的材料，**则** 实际发音为英式（或与偏好一致）。

### 边界与异常场景（必填）

- 无可用材料或题目 → 提示“暂无可练内容”或引导至其他模块；不崩溃。
- 音频加载失败或格式不支持 → 提示错误原因，允许重试或跳过；记录可观测信息。
- 播放中退到后台或来电 → 暂停或停止播放，恢复后可按设计恢复或重新播放；不泄漏资源。
- 发音偏好切换后尚未刷新 → 下次进入训练或下次播放时读取最新偏好并生效（与 EPIC-FR-002 一致）。

## FR / NFR *（必填）*

### FR（Functional Requirements）

- **FR-001**：用户能够选择听力材料并播放其音频；支持基本播放控制（至少：播放、暂停、进度跳转；倍速等在 Plan 定）。
- **FR-002**：用户能够完成与材料配套的题目或练习（如单选、填空、听写等至少一种题型），并提交答案。
- **FR-003**：用户能够查看练习结果与反馈（对错、得分、解析或正答中的至少一项）。
- **FR-004**：听力材料的音频发音（含 TTS 或可统一口音的部分）必须支持并遵循设置中的英式/美式偏好；偏好切换后，在下次播放或进入时生效。

### NFR（Non-Functional Requirements）

#### 性能（Performance）

- **NFR-PERF-001**：音频开始播放的端到端延迟不超过 2 秒（本地或已缓存资源，与 EPIC-NFR-PERF-002 一致）；播放过程中无持续卡顿或断音。

#### 功耗（Power）

- **NFR-POWER-001**：常规单次训练会话（约 5–10 分钟）下，音频播放带来的功耗增量在可接受范围；Top5% 用户模型与 mAh 上限在 Plan 阶段细化 [需澄清]。

#### 内存（Memory）

- **NFR-MEM-001**：单次听力训练会话的内存占用与回收符合应用整体约束（EPIC-NFR-MEM-001：常规会话 P50 不超过 300MB）；播放结束或退出后释放音频相关资源。

#### 安全与隐私（Security/Privacy）

- **NFR-SEC-001**：不新增敏感权限；听力材料与用户作答仅本地处理，不未经同意上传（与 EPIC-NFR-SEC-001 一致）。

#### 可观测性（Observability）

- **NFR-OBS-001**：播放失败、题目提交与完成率等关键节点可做轻量可观测（日志或埋点）；与 EPIC-NFR-OBS-001 对齐，首版可不强制产品埋点 [需澄清]。

#### 可靠性（Reliability）

- **NFR-REL-001**：本地材料或资源不可用时给出明确提示并可降级；播放被系统中断（如来电）后，可恢复或重新播放，不导致状态错乱或崩溃。

## 验收标准（Feature Level）*（必填）*

- **AC-001**：用户可完成“选材料 → 播放 → 做题 → 看结果”的完整流程；结果与反馈符合 FR-002、FR-003。
- **AC-002**：在设置中切换英式/美式后，听力材料中受发音偏好影响的部分在下次播放或进入时按新偏好发音；符合 FR-004、EPIC-FR-002。
- **AC-003**：本地/缓存音频从触发播放到出声的延迟 ≤2 秒，且播放流畅；符合 NFR-PERF-001。
- **AC-004**：无可用材料、音频加载失败、播放被中断等场景下，有明确提示且不崩溃；符合 NFR-REL-001 与边界场景。
- **AC-005**：不申请额外敏感权限，用户听力数据不未经同意上传；符合 NFR-SEC-001。

## 核心实体（如涉及数据则必填）

- **听力材料**：含义：一份可播放的音频及其元数据（标题、时长、难度等）；核心属性：音频资源引用、题目或练习关联；与题目为一对多或一对一。
- **题目/练习**：含义：与材料配套的作答单元；核心属性：题型、题干、选项或答案、解析；与材料关联，提交后生成作答记录。
- **作答记录 / 结果**：含义：用户某次练习的提交与反馈；核心属性：正误、得分、错题或解析；用于结果展示与后续统计（若 EPIC 有统一进度）。

## 假设与约束 *（必填）*

- **假设**：设置 Feature 已提供发音偏好读写接口；设备具备扬声器或耳机输出；首批材料为预置或 bundled，格式为系统可播。若假设不成立：无偏好时使用缺省（如美式）；无音频输出时仅能做题目、无播放；格式不支持时按故障模式降级。
- **约束**：Android 8.0+ / API 26+；遵循 EPIC 上项范围；TTS 或预录材料的英/美实现依赖系统或第三方引擎，本 Feature 负责调用时传入偏好参数。

## 需求追溯（预留，Plan 后填写）

| FR/NFR ID | 计划覆盖的 Story ID（Plan） | 任务覆盖（Tasks） | 备注 |
|---|---|---|---|
| FR-001 | ST-??? | T??? |  |
| FR-002 | ST-??? | T??? |  |
| FR-003 | ST-??? | T??? |  |
| FR-004 | ST-??? | T??? |  |
| NFR-PERF-001 | ST-??? | T??? |  |
| NFR-POWER-001 | ST-??? | T??? | [需澄清] |
| NFR-MEM-001 | ST-??? | T??? |  |
| NFR-SEC-001 | ST-??? | T??? |  |
| NFR-OBS-001 | ST-??? | T??? | [需澄清] |
| NFR-REL-001 | ST-??? | T??? |  |

## 变更记录（增量变更）

| 版本 | 日期 | 变更范围 | 变更摘要 | 影响 | 是否需要回滚 |
|---|---|---|---|---|---|
| v0.1.0 | 2026-01-25 | 全文 | 初始版本 | — | 否 |
